CREATE TABLE IF NOT EXISTS users
(
  user_id SERIAL PRIMARY KEY,
	first_name VARCHAR (50) NOT NULL,
	last_name VARCHAR (50) NOT NULL,
	username VARCHAR (50) UNIQUE NOT NULL,
	password VARCHAR (255) NOT NULL,
	email VARCHAR(25) UNIQUE NOT NULL,
	created_on TIMESTAMP(0) DEFAULT CURRENT_TIMESTAMP,
	last_login TIMESTAMP(0),
	timezone VARCHAR (40),
	profile_pic VARCHAR(50),
  reset_token_hash VARCHAR (255),
  reset_token_expires_at TIMESTAMP(0)
);

CREATE TABLE profile (
    user_id INT REFERENCES users(user_id) ON DELETE CASCADE,
    age INT,
    height NUMERIC(5, 2),
    weight INT
);

CREATE TABLE daily_exercise (
  user_id INTEGER NOT NULL REFERENCES users(user_id),
  date VARCHAR(10) NOT NULL,
  name VARCHAR(20) NOT NULL,
  target SMALLINT NOT NULL,
  actual SMALLINT NOT NULL,
  PRIMARY KEY (user_id, date)
);

CREATE TABLE stay_hydrated (
  user_id INTEGER NOT NULL REFERENCES users(user_id),
  date VARCHAR(10) NOT NULL,
  target SMALLINT NOT NULL,
  intaked SMALLINT NOT NULL,
  PRIMARY KEY (user_id, date)
);

CREATE TABLE quality_sleep (
  user_id INTEGER NOT NULL REFERENCES users(user_id),
  date VARCHAR(10) NOT NULL,
  bed_time TIME NOT NULL,
  wakeup_time TIME NOT NULL,
  sleep_duration TIME NOT NULL,
  PRIMARY KEY (user_id, date)
);

CREATE TABLE email_reminder (
  id SERIAL PRIMARY KEY,
  user_id INTEGER NOT NULL REFERENCES users(user_id) ON DELETE CASCADE,
  activity_category VARCHAR(20) NOT NULL,
  is_enabled BOOLEAN NOT NULL,
  start_time TIME(0) NOT NULL,
  end_time TIME(0) NOT NULL,
  frequency SMALLINT NOT NULL,
  pending_count SMALLINT DEFAULT 0,
  sent_count SMALLINT DEFAULT 0,
  failed_count SMALLINT DEFAULT 0,
  CONSTRAINT unique_user_activity UNIQUE (user_id, activity_category)
);

UPDATE email_reminder SET start_time='22:50', end_time='23:00';



















UPDATE users SET reset_token_hash = NULL , reset_token_expires_at=null;